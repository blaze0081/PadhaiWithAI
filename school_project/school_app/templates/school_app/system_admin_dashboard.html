{% extends 'school_app/base.html' %}
{% block content %}
<div class="content container mt-4">
<h1>Welcome to {{ school.name }}</h1>

<div class="row mt-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Students</h5>
                <p class="card-text">Total Students: {{ student_count }}</p>
                <a href="{% url 'student_list' %}" class="btn btn-primary">View Students</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Marks</h5>
                <p class="card-text">Manage student marks</p>
                <a href="{% url 'marks_list' %}" class="btn btn-primary">View Marks</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Solve Math</h5>
                <p class="card-text">Solve math questions</p>
                <a href="{% url 'math_tools' %}" class="btn btn-primary">Access Math Tools</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Analysis</h5>
                <p class="card-text">Student Performance Analysis</p>
                <a href="{% url 'analysis_dashboard' %}" class="btn btn-primary">View Analysis</a>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Test</h5>
                <p class="card-text">View Test List</p>
                <a href="{% url 'active_test_list' %}" class="btn btn-primary">View Test</a>
            </div>
        </div>
    </div>
</div>
	<style>
        /* ‚úÖ General Styles */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f9fafc;
        }

        .calendar-container {
            text-align: center;
            margin: 20px auto;
            max-width: 900px;
            padding: 20px;
            background: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        h2 {
            margin-bottom: 20px;
            font-size: 1.8em;
            color: #333;
        }

        /* ‚úÖ Navigation Controls */
        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .navigation button {
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        .navigation button:hover {
            background-color: #0056b3;
        }

        .current-month {
            font-size: 1.4em;
            font-weight: bold;
        }

        /* ‚úÖ Calendar Table */
        .calendar {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }

        .calendar th,
        .calendar td {
            border: 1px solid #ddd;
            text-align: center;
            padding: 5px;
            vertical-align: top;
            min-height: 50px;
        }

        .calendar th {
            background-color: #007BFF;
            color: white;
            font-weight: bold;
        }

        .calendar td {
            background-color: #ffffff;
        }

        .calendar .day {
            font-weight: bold;
            font-size: 14px;
            color: #333;
            margin-bottom: 5px;
        }

        .calendar .event {
            font-size: 10px;
            text-align: left;
            margin-top: 5px;
            background-color: #e3f2fd;
           // border-left: 4px solid #2196f3;
            padding: 1px;
            border-radius: 4px;
            //overflow: hidden;
            text-overflow: ellipsis;
            //white-space: nowrap;
        }

        /* ‚úÖ Dynamic Height for Empty Cells */
        .calendar td.no-event {
            height: 40px; /* Minimal height for empty cells */
        }

        /* ‚úÖ Responsive Design */
        @media (max-width: 768px) {
            .calendar th,
            .calendar td {
                padding: 5px;
                font-size: 12px;
            }

            .navigation button {
                padding: 5px 10px;
                font-size: 12px;
            }

            .current-month {
                font-size: 1.2em;
            }

            h2 {
                font-size: 1.4em;
            }
        }

        @media (max-width: 480px) {
            .calendar th,
            .calendar td {
                font-size: 10px;
                padding: 4px;
            }

            .event {
                font-size: 10px;
            }

            .navigation button {
                padding: 4px 8px;
                font-size: 10px;
            }

            .current-month {
                font-size: 1em;
            }

            h2 {
                font-size: 1.2em;
            }
        }
    </style>
<div class="calendar-container">
        <h2>üìÖ ‡§ï‡§ï‡•ç‡§∑‡§æ 10 ‡§∏‡•ç‡§§‡§∞ ‡§µ‡§æ‡§≤‡•á ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡§ø‡§Ø‡•ã‡§Ç ‡§ï‡•á ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§™‡§® ‡§π‡•á‡§§‡•Å ‡§∏‡§Æ‡§Ø ‡§∏‡§æ‡§∞‡§£‡•Ä</h2>
        <div class="navigation">
            <button onclick="prevMonth()">‚Üê Previous</button>
            <span id="currentMonth" class="current-month"></span>
            <button onclick="nextMonth()">Next ‚Üí</button>
        </div>
        <table class="calendar">
            <thead>
                <tr>
                    <th>‡§∞‡§µ‡§ø‡§µ‡§æ‡§∞</th>
                    <th>‡§∏‡•ã‡§Æ‡§µ‡§æ‡§∞</th>
                    <th>‡§Æ‡§Ç‡§ó‡§≤‡§µ‡§æ‡§∞</th>
                    <th>‡§¨‡•Å‡§ß‡§µ‡§æ‡§∞</th>
                    <th>‡§ó‡•Å‡§∞‡•Å‡§µ‡§æ‡§∞</th>
                    <th>‡§∂‡•Å‡§ï‡•ç‡§∞‡§µ‡§æ‡§∞</th>
                    <th>‡§∂‡§®‡§ø‡§µ‡§æ‡§∞</th>
                </tr>
            </thead>
            <tbody id="calendar-body"></tbody>
        </table>
    </div>

    <script>
        const events = [
            //{ start: '2025-01-07', end: '2025-01-07', title: 'Trainings' }, 
            { start: '2025-01-08', end: '2025-01-10', title: '- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 01 ‡§è‡§µ‡§Ç 03<br>01-‡§∏‡•ç‡§§‡§µ‡§ø‡§ï ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ‡§è‡§Å <br>03‚Äì‡§¶‡•ã ‡§ö‡§∞ ‡§µ‡§æ‡§≤‡•á ‡§∞‡•à‡§ñ‡§ø‡§ï ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£ ' }, 
            { start: '2025-01-11', end: '2025-01-11', title: '<p style="color: red;">- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 01 ‡§è‡§µ‡§Ç 03 ‡§ï‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® (‡§™‡•ç‡§∞‡§•‡§Æ)<br>-‡§Ö‡§≠‡§ø‡§≠‡§æ‡§µ‡§ï-‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§Æ‡•Ä‡§ü‡§ø‡§Ç‡§ó ‡§Æ‡•á‡§Ç ‡§≤‡§ï‡•ç‡§∑‡•ç‡§Ø 2025 ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä </p>' },
            { start: '2025-01-13', end: '2025-01-13', title: '- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 02,05 <br>02 - ‡§¨‡§π‡•Å‡§™‡§¶<br>05 ‚Äì ‡§∏‡§Æ‡§æ‡§®‡•ç‡§§‡§∞ ‡§∂‡•ç‡§∞‡•á‡§£‡•Ä' },
           // { start: '2025-01-14', end: '2025-01-14', title: '- HoliDay' },
            { start: '2025-01-15', end: '2025-01-16', title: '‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 02 ‡§è‡§µ‡§Ç 05<br>02-‡§¨‡§π‡•Å‡§™‡§¶<br>05‚Äì‡§∏‡§Æ‡§æ‡§®‡•ç‡§§‡§∞ ‡§∂‡•ç‡§∞‡•á‡§£‡•Ä' },
	    { start: '2025-01-20', end: '2025-01-20', title: '<p style="color: red;">- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 02 ‡§è‡§µ‡§Ç 05 ‡§ï‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® (‡§¶‡•ç‡§µ‡§ø‡§§‡•Ä‡§Ø)</p>' },
            { start: '2025-01-21', end: '2025-01-24', title: '- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 04, 07,14 <br>04- ‡§¶‡•ç‡§µ‡§ø‡§ò‡§æ‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£ <br>07- ‡§®‡§ø‡§∞‡•ç‡§¶‡•á‡§∂‡§æ‡§Ç‡§ï ‡§ú‡•ç‡§Ø‡§æ‡§Æ‡§ø‡§§‡§ø<br>14-‡§™‡•ç‡§∞‡§æ‡§Ø‡§ø‡§ï‡§§‡§æ' },
	    { start: '2025-01-25', end: '2025-01-25', title: '<p style="color: red;">- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 04, 07, 14 ‡§ï‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® (‡§§‡•É‡§§‡•Ä‡§Ø)</p>' },
	    { start: '2025-01-27', end: '2025-01-31', title: '- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 10,11,13<br>10 - ‡§µ‡•É‡§§ <br>11 - ‡§µ‡•É‡§§‡•ã‡§Ç ‡§∏‡•á ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ <br>13 - ‡§∏‡§æ‡§Ç‡§ñ‡•ç‡§Ø‡§ø‡§ï‡•Ä' },
      	    { start: '2025-02-01', end: '2025-02-01', title: '<p style="color: red;">- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 10, 11, 13 ‡§ï‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® (‡§ö‡§§‡•Å‡§∞‡•ç‡§•)</p>' },
	    { start: '2025-02-07', end: '2025-02-08', title: '- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø  06,08,09,12<br>06 - ‡§§‡•ç‡§∞‡§ø‡§≠‡•Å‡§ú <br>08 - ‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£‡§Æ‡§ø‡§§‡§ø ‡§ï‡§æ ‡§™‡§∞‡§ø‡§ö‡§Ø <br>09 - ‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£‡§Æ‡§ø‡§§‡§ø ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó <br>12 - ‡§™‡•É‡§∑‡•ç‡§†‡•Ä‡§Ø ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ ‡§è‡§µ‡§Ç ‡§Ü‡§Ø‡§§‡§®' },
{ start: '2025-02-10', end: '2025-02-14', title: '- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø  06,08,09,12<br>06 - ‡§§‡•ç‡§∞‡§ø‡§≠‡•Å‡§ú <br>08 - ‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£‡§Æ‡§ø‡§§‡§ø ‡§ï‡§æ ‡§™‡§∞‡§ø‡§ö‡§Ø <br>09 - ‡§§‡•ç‡§∞‡§ø‡§ï‡•ã‡§£‡§Æ‡§ø‡§§‡§ø ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó <br>12 - ‡§™‡•É‡§∑‡•ç‡§†‡•Ä‡§Ø ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞‡§´‡§≤ ‡§è‡§µ‡§Ç ‡§Ü‡§Ø‡§§‡§®' },	    
{ start: '2025-02-15', end: '2025-02-15', title: '<p style="color: red;">- ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 06,08,09 ‡§è‡§µ‡§Ç 12 ‡§ï‡§æ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® (‡§™‡§Ç‡§ö‡§Æ)</p>' },
        ];

        let currentDate = new Date();

        function renderCalendar(date) {
            const calendarBody = document.getElementById('calendar-body');
            const currentMonth = document.getElementById('currentMonth');
            calendarBody.innerHTML = '';

            const year = date.getFullYear();
            const month = date.getMonth();

            currentMonth.innerText = `${date.toLocaleString('default', { month: 'long' })} ${year}`;

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            let row = '<tr>';
            for (let i = 0; i < firstDay; i++) row += '<td></td>';

            for (let day = 1; day <= daysInMonth; day++) {
                let fullDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                let eventHTML = events.filter(e => fullDate >= e.start && fullDate <= e.end)
                                      .map(e => `<div class="event">${e.title}</div>`).join('');
                let cellClass = eventHTML ? '' : 'no-event';
                row += `<td class="${cellClass}"><div class="day">${day}</div>${eventHTML}</td>`;
                if ((day + firstDay) % 7 === 0) row += '</tr><tr>';
            }

            row += '</tr>';
            calendarBody.innerHTML = row;
        }

        function prevMonth() { currentDate.setMonth(currentDate.getMonth() - 1); renderCalendar(currentDate); }
        function nextMonth() { currentDate.setMonth(currentDate.getMonth() + 1); renderCalendar(currentDate); }

        renderCalendar(currentDate);
    </script>
	
<h2 class="mt-5">Active Tests</h2>
<table class="table table-bordered mt-3">
    <thead>
        <tr>
            <th>Test Number</th>
            <th>Test Name</th>
            <th>Subject/Chapter Name</th>
            <th>Questions File</th>
            <th>Answers File</th>
            <th>Test Date</th>
            <th>Update Marks</th>
        </tr>
    </thead>
    <tbody>
        {% for test in active_tests %}
        <tr>
            <td>{{ test.test_number }}</td>
            <td>{{ test.test_name }}</td>
            <td>{{ test.subject_name }}</td>
            <td>
                {% if test.pdf_file_questions %}
					<a href="{{ test.pdf_file_questions.url }}" class="btn btn-danger btn-sm " download>Download PDF</a>
				{% else %}
					<p>No PDF available for download.</p>
				{% endif %}
                
                </td>
            <td>
                
                {% if test.pdf_file_answers %}
					<a href="{{ test.pdf_file_answers.url }}" class="btn btn-success info btn-sm" download>Download PDF</a>
				{% else %}
					<p>No PDF available for download.</p>
				{% endif %}
                </td>
            <td>{{ test.test_date }}</td>
            <td>
              <a href="{% url 'test_marks_entry' test.test_number   %}" class="btn btn-info ">Update Marks</a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5">No active tests available.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>
{% endblock %}
